(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4392:function(e,t,r){Promise.resolve().then(r.bind(r,8098))},8098:function(e,t,r){"use strict";let s;r.r(t),r.d(t,{default:function(){return N}});var n=r(7437),a=r(2265),l=r(6782),o=r(6371),i=r(9769),d=r(3167),c=r(1367);function u(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,c.m6)((0,d.W)(t))}let f=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-xs hover:bg-destructive/90",outline:"border border-input bg-background shadow-xs hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),m=a.forwardRef((e,t)=>{let{className:r,variant:s,size:a,asChild:l=!1,...i}=e,d=l?o.g7:"button";return(0,n.jsx)(d,{className:u(f({variant:s,size:a,className:r})),ref:t,...i})});function h(e){let{socket:t,studentId:r,classCode:s,isTeacher:l,onBoardClick:o}=e,i=(0,a.useRef)(null),[d,c]=(0,a.useState)(!1),[u,f]=(0,a.useState)("#000000"),[h,p]=(0,a.useState)(2),[x,g]=(0,a.useState)("draw"),[v,j]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=i.current;if(!e)return;let n=e.getContext("2d");if(n)return n.fillStyle="#ffffff",n.fillRect(0,0,e.width,e.height),l&&t.emit("request-canvas-state",{classCode:s,studentId:r}),t.on("draw-update-received",e=>{let{studentId:t,drawData:s,canvasState:n}=e;t===r&&(n?b(n):s&&w(s))}),t.on("canvas-state-update",e=>{let{studentId:t,canvasState:s}=e;t===r&&s&&b(s)}),()=>{t.off("draw-update-received"),t.off("canvas-state-update")}},[t,r,s,l]);let b=e=>{let t=i.current,r=null==t?void 0:t.getContext("2d");if(!t||!r)return;let s=new Image;s.onload=()=>{r.clearRect(0,0,t.width,t.height),r.drawImage(s,0,0)},s.src=e},w=e=>{var t;let r=i.current,s=null==r?void 0:r.getContext("2d");if(r&&s&&(null==e?void 0:null===(t=e.points)||void 0===t?void 0:t.length)){s.beginPath(),s.moveTo(e.points[0].x,e.points[0].y),"erase"===e.type?(s.globalCompositeOperation="destination-out",s.strokeStyle="rgba(0,0,0,1)"):(s.globalCompositeOperation="source-over",s.strokeStyle=e.color),s.lineWidth=e.width,s.lineCap="round";for(let t=1;t<e.points.length;t++)s.lineTo(e.points[t].x,e.points[t].y);s.stroke(),s.closePath(),s.globalCompositeOperation="source-over"}},N=()=>{c(!1),j(null);let e=i.current;if(e&&!l){let n=e.toDataURL();t.emit("draw-update",{classCode:s,studentId:r,drawData:null,canvasState:n})}};return(0,n.jsxs)("div",{className:"relative border border-input rounded-lg shadow-md",onClick:o,children:[(0,n.jsx)("canvas",{ref:i,width:600,height:400,className:"touch-none w-full h-full rounded-lg",onPointerDown:e=>{if(l){o&&o();return}let t=i.current;if(!t)return;let r=t.getBoundingClientRect(),s=e.clientX-r.left,n=e.clientY-r.top;c(!0),j({x:s,y:n})},onPointerMove:e=>{if(!d||l||!v)return;let n=i.current;if(!n)return;let a=n.getBoundingClientRect(),o=e.clientX-a.left,c=e.clientY-a.top,f={points:[v,{x:o,y:c}],color:u,width:h,type:x};w(f);let m=n.toDataURL();t.emit("draw-update",{classCode:s,studentId:r,drawData:f,canvasState:m}),j({x:o,y:c})},onPointerUp:N,onPointerLeave:N}),!l&&(0,n.jsx)("div",{className:"absolute bottom-4 left-4 flex gap-2 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 p-2 rounded-lg shadow-md border border-input",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("input",{type:"color",value:u,onChange:e=>f(e.target.value),className:"w-8 h-8 rounded cursor-pointer"}),(0,n.jsx)(m,{onClick:()=>g("draw"),variant:"draw"===x?"default":"secondary",size:"sm",children:"Draw"}),(0,n.jsx)(m,{onClick:()=>g("erase"),variant:"erase"===x?"default":"secondary",size:"sm",children:"Erase"}),(0,n.jsx)(m,{onClick:()=>{let e=i.current,n=null==e?void 0:e.getContext("2d");if(!e||!n)return;n.fillStyle="#ffffff",n.fillRect(0,0,e.width,e.height);let a=e.toDataURL();t.emit("draw-update",{classCode:s,studentId:r,drawData:null,canvasState:a})},variant:"destructive",size:"sm",children:"Clear"})]})})]})}m.displayName="Button";let p=a.forwardRef((e,t)=>{let{className:r,type:s,...a}=e;return(0,n.jsx)("input",{type:s,className:u("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...a})});p.displayName="Input";let x=a.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:u("rounded-xl border bg-card text-card-foreground shadow",r),...s})});x.displayName="Card";let g=a.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:u("flex flex-col space-y-1.5 p-6",r),...s})});g.displayName="CardHeader";let v=a.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("h3",{ref:t,className:u("font-semibold leading-none tracking-tight",r),...s})});v.displayName="CardTitle",a.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("p",{ref:t,className:u("text-sm text-muted-foreground",r),...s})}).displayName="CardDescription";let j=a.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:u("p-6 pt-0",r),...s})});j.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:u("flex items-center p-6 pt-0",r),...s})}).displayName="CardFooter";let b=["Happy","Clever","Bright","Swift","Gentle","Bold","Calm","Wise","Kind","Quick","Brave","Smart","Eager","Fair","Pure","Warm","Sharp","Fresh","Noble","Proud"],w=["Panda","Eagle","Tiger","Dolphin","Lion","Wolf","Bear","Fox","Hawk","Deer","Owl","Swan","Horse","Robin","Dove","Seal","Lynx","Elk","Hare","Crane"];function N(){let[e,t]=(0,a.useState)(!1),[r,o]=(0,a.useState)(!1),[i,d]=(0,a.useState)(""),[c,u]=(0,a.useState)(""),[f,N]=(0,a.useState)(""),[y,C]=(0,a.useState)([]),[k,S]=(0,a.useState)(null),[R,B]=(0,a.useState)(null),[D,P]=(0,a.useState)("");return((0,a.useEffect)(()=>{try{return(s=(0,l.io)("https://".concat("localhost:3000"),{path:"/socket.io",transports:["websocket"],reconnectionAttempts:5,reconnectionDelay:1e3})).on("connect",()=>{if(console.log("Connected to server"),t(!0),B(null),s.id){N(s.id);let e=function(){let e=b[Math.floor(Math.random()*b.length)],t=w[Math.floor(Math.random()*w.length)];return"".concat(e).concat(t)}();P(e),console.log("Generated name:",e)}}),s.on("connect_error",e=>{console.error("Connection error:",e),B("Failed to connect to GalleryBoard server. Please try connecting again."),t(!1)}),s.on("classroom-created",e=>{let{classCode:t}=e;d(t)}),s.on("student-joined",e=>{let{studentId:t,displayName:r,students:s}=e;console.log("Student joined:",{studentId:t,displayName:r}),C(s)}),s.on("name-assigned",e=>{let{displayName:t}=e;console.log("Name assigned:",t),P(t)}),s.on("student-left",e=>{let{students:t}=e;C(t)}),()=>{s.disconnect()}}catch(e){console.error("Socket initialization error:",e),B("Failed to initialize connection. Please refresh the page.")}},[]),e)?i?r?(0,n.jsxs)("div",{className:"p-8",children:[(0,n.jsx)(x,{className:"mb-6",children:(0,n.jsx)(j,{className:"p-6",children:(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("h2",{className:"text-2xl font-bold",children:["Class Code: ",i]}),(0,n.jsxs)("p",{className:"text-muted-foreground",children:["Connected Students: ",y.length]})]}),k&&(0,n.jsx)(m,{onClick:()=>S(null),variant:"outline",children:"Back to Grid"})]})})}),k?(0,n.jsx)(x,{children:(0,n.jsx)(j,{className:"p-6",children:(0,n.jsx)(h,{socket:s,studentId:k,classCode:i,isTeacher:!0})})}):(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:y.map(e=>(0,n.jsx)(x,{className:"cursor-pointer hover:shadow-lg transition-shadow",children:(0,n.jsxs)(j,{className:"p-4",children:[(0,n.jsx)(h,{socket:s,studentId:e.id,classCode:i,isTeacher:!0,onBoardClick:()=>S(e.id)}),(0,n.jsx)("p",{className:"mt-2 text-center text-sm text-muted-foreground",children:e.displayName})]})},e.id))})]}):(0,n.jsxs)("div",{className:"p-8",children:[(0,n.jsx)(x,{className:"mb-6",children:(0,n.jsxs)(j,{className:"p-6",children:[(0,n.jsxs)("h2",{className:"text-2xl font-bold",children:["Class Code: ",i]}),(0,n.jsxs)("p",{className:"text-muted-foreground",children:["Your Name: ",D]})]})}),(0,n.jsx)(x,{children:(0,n.jsx)(j,{className:"p-6",children:(0,n.jsx)(h,{socket:s,studentId:f,classCode:i})})})]}):(0,n.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen p-4",children:(0,n.jsxs)(x,{className:"w-full max-w-md",children:[(0,n.jsx)(g,{children:(0,n.jsx)(v,{className:"text-2xl text-center",children:"GalleryBoard"})}),(0,n.jsxs)(j,{className:"space-y-4",children:[(0,n.jsx)(m,{onClick:()=>{s.id&&(o(!0),s.emit("create-classroom",s.id))},className:"w-full",size:"lg",children:"Create Classroom (Teacher)"}),(0,n.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,n.jsx)(p,{type:"text",value:c,onChange:e=>u(e.target.value.toUpperCase()),placeholder:"Enter class code",className:"text-center"}),(0,n.jsx)(m,{onClick:()=>{s.id&&c&&(console.log("Joining classroom with name:",D),s.emit("join-classroom",{classCode:c,studentId:s.id,displayName:D}),d(c))},variant:"secondary",size:"lg",children:"Join Classroom"})]})]})]})}):(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,n.jsx)(x,{children:(0,n.jsxs)(j,{className:"p-6",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto"}),(0,n.jsx)("p",{className:"text-center mt-4",children:R||"Connecting to GalleryBoard server..."}),R&&(0,n.jsx)(m,{onClick:()=>window.location.reload(),variant:"outline",className:"mt-4 w-full",children:"Retry Connection"})]})})})}}},function(e){e.O(0,[569,971,69,744],function(){return e(e.s=4392)}),_N_E=e.O()}]);